#!/usr/bin/env bash
# b5 Taskfile, see https://git.team23.de/build/b5 for details

task:run() {
    docker:docker-compose up "$@"
}

task:halt() {
    docker:docker-compose down "$@"
}

task:composer() {
    docker:command:composer "$@"
}

task:composer-cms() {
    docker:command:composer-cms "$@"
}

task:artisan() {
    docker:command:artisan "$@"
}

task:npm() {
    docker:command:npm "$@"
}

task:npm-cms() {
    docker:command:npm-cms "$@"
}

task:phpunit() {
    docker:command:phpunit "$@"
}

task:phpunit-cms() {
    docker:command:phpunit-cms "$@"
}

task:shell() {
    container="$1"
    command="$2"
    additionalArguments="${@:3}"
    docker:container_run "${container:-php}" "${command:-/bin/bash}" ${additionalArguments:-}
}

task:link-assets(){
    DIR="../web/public/vendor/cms"
    if [[ ! -d "$DIR" ]]; then
      mkdir -p ${DIR}
    else
      rm -rf ${DIR}
    fi
    if [[ ! -L "$DIR" ]]; then
      (
        cd ../web/public/vendor && ln -s ../../../packages/laravel-cms/dist cms
      )
    fi
}
